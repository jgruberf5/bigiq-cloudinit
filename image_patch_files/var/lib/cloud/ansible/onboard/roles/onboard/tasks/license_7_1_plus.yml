---
- name: Verify license is provided
  fail:
    msg: "You must provide a license via license_key"
  when: license_key is not defined

- name: Activate the license
  shell: "/usr/local/bin/SOAPLicenseClient --basekey {{ license_key }}"
  register: activate_license
  when: license_key is defined

- name: Verify license is provided
  fail:
    msg: "{{ License activation failed }}"
  when: activate_license is not success